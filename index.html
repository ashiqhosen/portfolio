<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Get instant portfolio - Powerfull ChatBOT</title>
<link rel="icon" type="image/x-icon" href="activateashiq.png">
<style>
.msg.bot a {
    color: #bccef3 !important;
}


:root { --bg:#0b1220; --panel:#111a2b; --muted:#8aa0b2; --text:#e6edf3; --accent:#6ca4ff; --shadow:0 10px 30px rgba(0,0,0,.25); --radius:16px;}
*{box-sizing:border-box;}
body{margin:0;font-family:ui-sans-serif, system-ui, Segoe UI, Roboto, Helvetica, Arial; background:var(--bg); color:var(--text);}
.container{max-width:1200px;margin:0 auto;padding:24px;display:grid;gap:20px;grid-template-columns:280px 1fr;}
@media(max-width:900px){.container{grid-template-columns:1fr;}}
.card{background:var(--panel); border-radius:var(--radius);box-shadow:var(--shadow);}
.sidebar{padding:18px;position:sticky;top:16px;height:fit-content;}
.sidebar h2{margin:0 0 12px;font-size:18px;font-weight:700;}
.sidebar .tip{color:var(--muted);font-size:13px;line-height:1.5;}
.badge{display:inline-block;padding:4px 8px;border-radius:12px;background:rgba(108,164,255,.15);color:var(--accent);font-size:12px;margin:4px 6px 0 0;}
.chat{display:flex;flex-direction:column;height:calc(100vh - 120px);min-height:520px;justify-content: space-between;}
.chat-header{padding:18px;border-bottom:1px solid rgba(255,255,255,.06);display:flex;align-items:center;justify-content:space-between;}
.title{font-weight:800;letter-spacing:.2px;}
.pill{font-size:12px;color:var(--muted);}
.chat-body{padding:18px;overflow:auto;display:flex;flex-direction:column;gap:12px;}
.msg{max-width:92%;line-height:1.55;position:relative;white-space:pre-line;}
.user{align-self:flex-end;background:rgba(108,164,255,.18);border-radius:14px;padding:12px 14px;}
.bot{align-self:flex-start;background:rgba(255,255,255,.03);border-radius:14px;padding:12px 14px;}
.muted{color:var(--muted);font-size:13px;}
.chat-footer{padding:12px;display:flex;gap:10px;border-top:1px solid rgba(255,255,255,.06);}
.input{flex:1;background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:12px 14px;color:var(--text);outline:none;}
.btn{background:linear-gradient(135deg,var(--accent),#9ad0ff);color:#07203b;border:0;border-radius:12px;padding:12px 16px;font-weight:700;cursor:pointer;box-shadow:0 6px 18px rgba(108,164,255,.3);}
.btn:disabled{opacity:.6;cursor:not-allowed;}
.loader{width:28px;height:28px;border-radius:50%;border:3px solid rgba(255,255,255,.12);border-top-color:var(--accent);animation:spin 1s linear infinite;margin-right:8px;}
@keyframes spin{to{transform:rotate(360deg);}}
.flex{display:flex;align-items:center;gap:8px;}
.copy-btn{background:var(--accent);color:#07203b;border:none;border-radius:6px;padding:4px 8px;font-size:12px;cursor:pointer;margin-top:8px;display:inline-block;}
.devs-my-about *{margin: 0px;}
.devs-my-about{text-align:center;border: 1px solid #07305b; border-radius: 10px; padding: 20px;margin-bottom: 15px;}
.devs-my-about img{width: 80px; height: 80px; object-fit: cover;border-radius: 50%;margin-bottom: 10px;}
.devs-my-about .contact-btn{padding: 6px 16px; border-radius: 6px; background: #07305b; color: #6ca4ff; border: 1px solid #07305b; font-size: 13px; font-weight: 500; margin-top: 10px; cursor: pointer; display: inline-block;text-decoration: none;}
.devs-my-about .contact-btn:hover{color: #fff;background-color: #6ca4ff;border: 1px solid #6ca4ff;}
.devs-my-about:hover{border: 1px solid #6ca4ff;}
html,body{overflow-y: hidden;}
.status-check{font-size:13px;margin-left:8px;}
</style>
</head>
<body>
<div class="container">
<aside class="sidebar card">
<div class="devs-my-about">
<img src="activateashiq.png" alt="Ashiq">
<h3>Ashiqur Rahman</h3>
<p>WordPress & LMS Expert</p>
<a href="mailto:ashiq@devsoffice.com" class="contact-btn">Contact</a>
<a target="_blank" href="https://ashiqhosen.github.io/portfolio/add.html" class="contact-btn">New Portfolio</a>
<a target="_blank" href="https://ashiqhosen.github.io/portfolio/keyword.html" class="contact-btn">New Portfolio</a>
</div>
<h2>How to ask</h2>
<div class="tip">Ask by plugin, type, industry, or site. Or type number like <b>5</b>, <b>7</b>, <b>10</b> to see random websites.
<div class="badge">membership</div>
<div class="badge">learndash</div>
<div class="badge">education</div>
<div class="badge">devsoffice.com</div>
</div>
</aside>
<main class="card chat" id="app">
<div class="chat-header">
<div><div class="title">Portfolio Finder</div>
<div class="pill">Fuzzy & related matching</div></div>
</div>
<div class="chat-body" id="chat"></div>
<div class="chat-footer">
<input id="q" class="input" placeholder="Type plugin, site, type, industry or number..."/>
<button class="btn" id="send">Send</button>
</div>
</main>
</div>

<script type="module">
import {projects} from './projects.js';
import {synonyms} from './synonyms.js';

const state = {projects, synonyms, memory:[]};
const chat = document.getElementById('chat');
const input = document.getElementById('q');
const sendBtn = document.getElementById('send');

const humanResponses = [
  "Here are some websites you might like:",
  "These match your query:",
  "Portfolio results:",
  "Random selection for you:"
];

// Helper functions
function addMsg(content,who='bot'){
  removeTyping();
  const el=document.createElement('div');
  el.className='msg '+who;
  el.innerHTML=content;
  chat.appendChild(el);
  chat.scrollTop=chat.scrollHeight;

  // Add copy button for bot messages
  if(who==='bot'){
    const btn=document.createElement('button');
    btn.className='copy-btn';
    btn.textContent='Copy';
    el.appendChild(btn);

    btn.addEventListener('click',()=>{
      // Clone the content to safely remove status spans
      const tempDiv = document.createElement('div');
      tempDiv.innerHTML = content;
      // Remove all status-check spans
      tempDiv.querySelectorAll('.status-check').forEach(el => el.remove());
      // Convert <br> to newlines and strip HTML tags
      const plainText = tempDiv.innerHTML.replace(/<br>/g, '\n').replace(/<[^>]+>/g, '');
      navigator.clipboard.writeText(plainText);
      btn.textContent='Copied!';
      setTimeout(()=>{btn.textContent='Copy';},1000);
    });
  }

  // After rendering, check status for URLs
  checkAllStatuses(el);
}

function addTyping(){
  const el=document.createElement('div');
  el.className='msg bot';
  el.id='typing';
  el.innerHTML='<div class="flex"><div class="loader"></div><span class="muted">Typing‚Ä¶</span></div>';
  chat.appendChild(el);
  chat.scrollTop=chat.scrollHeight;
}
function removeTyping(){
  const prevTyping=document.getElementById('typing');
  if(prevTyping) prevTyping.remove();
}

// Synonym & fuzzy
function expandSynonyms(token){
  for(const key in synonyms){
    if(synonyms[key].includes(token)) return key;
  }
  return token;
}
function fuzzyMatch(str,token){
  str=str.toLowerCase(); token=token.toLowerCase();
  if(str.includes(token)) return true;
  return str.includes(token.slice(0,Math.floor(token.length/2)));
}

// Number detection
function getNumberFromQuery(query) {
  const match = query.match(/(\d+)\s*(‡¶ü‡¶ø|ta|‡¶ü‡¶ø)?/);
  if (match) return parseInt(match[1]);
  return null;
}

// Shuffle array
function shuffle(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

// Main search
function searchProjects(query){
  const tokens=query.toLowerCase().split(/\s+/).map(expandSynonyms);
  const showDetails=tokens.includes('show');
  let matched=state.projects.filter(proj=>
    tokens.some(tok=>
      fuzzyMatch(proj.name,tok) ||
      proj.plugins.some(p=>fuzzyMatch(p,tok)) ||
      fuzzyMatch(proj.type,tok) ||
      fuzzyMatch(proj.industry,tok)
    )
  );
  let isExact = matched.length>0;

  if(!isExact){
    matched=state.projects.filter(proj=>
      tokens.some(tok=>
        proj.plugins.concat([proj.type,proj.industry]).some(p=>p.toLowerCase().includes(tok))
      )
    );
  }

  // ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ ‡¶¨‡ßá‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®
  const num = getNumberFromQuery(query);
  if (num) {
    matched = shuffle([...matched]).slice(0, num);
    if (matched.length === 0) return "Sorry, I couldn't find any project related to your request.";
    let text = '';
    matched.forEach((proj, idx) => {
      text += `${idx+1}. <a href="${proj.url}" target="_blank">${proj.url}</a> <span class="status-check" id="status-${proj.url.replace(/[^a-zA-Z0-9]/g,'')}">Checking‚Ä¶</span><br>`;
    });
    return `Here are ${matched.length} random websites:<br><br>` + text;
  }

  if(matched.length===0) return "Sorry, I couldn't find any project related to your request.";
  let intro = isExact ? humanResponses[Math.floor(Math.random()*humanResponses.length)] + "<br><br>" : "No exact match, but these might be related:<br><br>";
  let text='';
  matched.forEach((proj,idx)=>{
    text+=`${idx+1}. <a href="${proj.url}" target="_blank">${proj.url}</a> <span class="status-check" id="status-${proj.url.replace(/[^a-zA-Z0-9]/g,'')}">Checking‚Ä¶</span><br>`;
  });
  return intro + text;
}

// Status check logic
function checkAllStatuses(container){
  // Find all anchor tags with URLs
  const anchors = container.querySelectorAll('a[href^="http"]');
  anchors.forEach(anchor=>{
    const url = anchor.getAttribute('href');
    const statusSpan = container.querySelector(`#status-${url.replace(/[^a-zA-Z0-9]/g,'')}`);
    if(statusSpan){
      checkSiteStatus(url, statusSpan);
    }
  });
}

// Use favicon trick for status check (frontend only)
function checkSiteStatus(url, statusSpan){
  // Try favicon first
  const faviconUrl = url.replace(/\/$/,'') + '/favicon.ico';
  let done = false;
  const timeout = setTimeout(()=>{
    if(!done){
      statusSpan.textContent = 'Offline / Maintenance ‚ùå';
      statusSpan.style.color = '#ff4d4d';
      done = true;
    }
  }, 5000);

  const img = new Image();
  img.onload = function(){
    if(!done){
      statusSpan.textContent = 'Live ‚úÖ';
      statusSpan.style.color = '#4caf50';
      clearTimeout(timeout);
      done = true;
    }
  };
  img.onerror = function(){
    // Try fetch HEAD as fallback (may fail due to CORS)
    fetch(url, {method:'HEAD',mode:'no-cors'})
      .then(()=>{
        if(!done){
          statusSpan.textContent = 'Live ‚úÖ';
          statusSpan.style.color = '#4caf50';
          clearTimeout(timeout);
          done = true;
        }
      })
      .catch(()=>{
        if(!done){
          statusSpan.textContent = 'Offline / Maintenance ‚ùå';
          statusSpan.style.color = '#ff4d4d';
          clearTimeout(timeout);
          done = true;
        }
      });
  };
  img.src = faviconUrl;
}

// Chatbot UI logic
function handleSend(){
  const val = input.value.trim();
  if(!val) return;
  addMsg(val,'user');
  addTyping();
  setTimeout(()=>{
    const res = searchProjects(val);
    addMsg(res,'bot');
  },700);
  input.value='';
}

sendBtn.addEventListener('click',handleSend);
input.addEventListener('keydown',e=>{
  if(e.key==='Enter') handleSend();
});

// Initial greeting
addMsg(`üëã Hi there! Type a <b>plugin, site type, industry, or a number</b> (like <b>5</b> or <b>10</b>) to get random website links.

üí° Examples you can try:

- Show me 5 education websites using LearnDash
- I want 3 membership sites built with WordPress
- Give me 7 corporate websites
- List 10 websites using WooCommerce
- Find sites in the education or corporate industry


‚ú® Tips:
- Combine <b>plugin + industry + number</b> for precise results.
- Add the word <b>‚Äúshow‚Äù</b> for full details about websites (plugins, type, industry).
- Numbers return <b>random websites</b>, so results change every time.
`, 'bot');

</script>
</body>
</html>
